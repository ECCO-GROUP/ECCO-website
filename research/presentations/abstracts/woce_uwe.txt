Adjoint Compiler Technology and Standards

Uwe Nauman, Patrick Heimbach, Christopher Hill and Carl Wunsch

Adjoint models are important both to understanding the sensitivity of the 
ocean state to initial/boundary conditions, model parameters of all types, 
and in a secondary role as a numerical method for doing data assimilation.  
Although also important in engineering, economics, and most scientific 
disciplines, they have thus far found their widest and most advanced applications 
in physical oceanography. While oceanographers have long experience in 
constructing `direct' or forward models, the construction of the corresponding 
adjoint model has proven, for many, burdensome and tedious. The advent of 
compilers capable of generating the adjoint model nearly automatically from the 
forward code has been revolutionary.
 
The adjoint corresponds to taking the derivatives of the direct model with 
respect to any field or parameter subject to change. Its numerical values 
can be computed using either a tangent-linear or an adjoint model both of 
which can be generated by compilers for Automatic Differentiation (AD). The 
problems arising from making this source transformation fully automatic are 
investigated as part of a collaborative NSF-ITR funded research project between 
MIT, Rice University, and Argonne National Laboratory / University of Chicago. 
The project's goals are to develop a fully-automatic, easy to use open-source tool 
for AD that is immediately applicable to Fortran and C codes and that is designed 
to allow community extension to include more elaborate code transformations, for 
example Hessian calculation. A primary focus of the project is geophysical applications.
 
The poster gives an overview of how compilers for AD work in principle. Various 
successful applications illustrate the feasibility of the general approach. Some 
of the major challenges in the field are discussed. Features of forward model 
implementations that are favorable from the point of view of automatic adjoint code
generation are proposed.  

